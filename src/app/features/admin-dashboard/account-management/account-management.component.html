<!-- Section de gestion des comptes -->
<section
  class="account-management mb-12 p-6 bg-secondary rounded-lg shadow-xl shadow-tertiary"
>
  <h2 class="text-2xl font-semibold mb-8 text-center">
    Création et gestion des comptes
  </h2>

  <div class="flex flex-col lg:flex-row gap-8">
    <!-- Formulaire de création/mise à jour de compte -->
    <div class="w-full lg:w-1/2 bg-gray-100 p-6 rounded-lg shadow-sm">
      <h3 class="text-xl font-semibold mb-4">
        {{ newUser.id ? "Modifier le compte" : "Créer un compte" }}
      </h3>
      <form class="space-y-4">
        <div>
          <label for="username" class="block text-lg font-medium mb-2"
            >Nom d'utilisateur:</label
          >
          <input
            type="text"
            id="username"
            [(ngModel)]="newUser.username"
            name="username"
            required
            class="w-full p-2 border border-gray-300 rounded-md"
          />
        </div>
        <div>
          <label for="email" class="block text-lg font-medium mb-2"
            >Email:</label
          >
          <input
            type="email"
            id="email"
            [(ngModel)]="newUser.email"
            name="email"
            required
            class="w-full p-2 border border-gray-300 rounded-md"
          />
        </div>
        <div>
          <label for="password" class="block text-lg font-medium mb-2"
            >Mot de passe:</label
          >
          <input
            type="password"
            id="password"
            [(ngModel)]="newUser.password"
            name="password"
            [required]="!newUser.id"
            placeholder="{{
              newUser.id ? 'Laissez vide si non modifié' : 'Mot de passe requis'
            }}"
            class="w-full p-2 border border-gray-300 rounded-md"
          />
        </div>
        <div>
          <label for="role" class="block text-lg font-medium mb-2">Rôle:</label>
          <select
            id="role"
            [(ngModel)]="newUser.role"
            name="role"
            class="w-full p-2 border border-gray-300 rounded-md"
            required
          >
            <option value="">- Choisir un rôle -</option>
            @for (role of roles; track role.id) {
            <option [ngValue]="role">{{ role.name }}</option>
            }
          </select>
        </div>
        <div class="flex space-x-2">
          <app-button
            [text]="newUser.id ? 'Modifier' : 'Créer'"
            [type]="'button'"
            [color]="'tertiary'"
            [rounded]="true"
            class="'w-1/2 sm:w-1/3 lg:w-1/4 font-bold px-4'"
            (click)="newUser.id ? updateAccount() : createAccount()"
          ></app-button>
          <app-button
            [text]="'Annuler'"
            [type]="'button'"
            [color]="'secondary'"
            [rounded]="true"
            class="'w-1/2 sm:w-1/3 lg:w-1/4 font-bold px-2'"
            (click)="cancel()"
          ></app-button>
        </div>
      </form>
    </div>

    <!-- Liste des comptes -->
    <div class="w-full lg:w-1/2 bg-gray-100 p-6 rounded-lg shadow-sm">
      <h3 class="text-xl font-semibold mb-4">Liste des comptes</h3>
      <table class="w-full border-collapse bg-white rounded-lg shadow-sm">
        <thead>
          <tr class="bg-gray-200 text-left text-sm font-semibold text-gray-700">
            <th class="border p-3">Nom</th>
            <th class="border p-3">Email</th>
            <th class="border p-3">Rôle</th>
            <th class="border p-3">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (user of users; track user.id) {
          <tr class="border-b last:border-0">
            <td class="border p-3">{{ user.username }}</td>
            <td class="border p-3">{{ user.email }}</td>
            <td class="border p-3">
              {{ user.role.name || "Rôle non défini" }}
            </td>

            <td class="border p-3">
              <!-- Actions avec flexbox pour aligner les boutons et des tailles réduites -->
              <div class="flex space-x-2">
                <app-button
                  [text]="'Modifier'"
                  [type]="'button'"
                  [color]="'secondary'"
                  [rounded]="true"
                  [customClass]="'text-xs px-2 py-1 w-auto font-bold'"
                  (click)="editUser(user)"
                ></app-button>
                <app-button
                  [text]="'Supprimer'"
                  [type]="'button'"
                  [color]="'red'"
                  [rounded]="true"
                  [customClass]="'text-xs px-2 py-1 w-auto font-bold'"
                  (click)="deleteAccount(user.id)"
                ></app-button>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</section>
