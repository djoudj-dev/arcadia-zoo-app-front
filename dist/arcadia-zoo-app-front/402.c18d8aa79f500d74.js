"use strict";(self.webpackChunkarcadia_zoo_app_front=self.webpackChunkarcadia_zoo_app_front||[]).push([[402],{2402:(b,u,n)=>{n.r(u),n.d(u,{UpdatePasswordComponent:()=>g});var l=n(177),t=n(9417),m=n(6029),p=n(8219),e=n(4438),f=n(9172),_=n(2773),v=n(494),w=n(9702);const d=o=>({"border-red-300 ring-red-300":o});function h(o,c){1&o&&(e.j41(0,"p",8),e.EFF(1," Le mot de passe actuel est requis "),e.k0s())}function E(o,c){1&o&&(e.j41(0,"p",8),e.EFF(1," Le mot de passe doit respecter les crit\xe8res de s\xe9curit\xe9 "),e.k0s())}function P(o,c){1&o&&(e.j41(0,"p",8),e.EFF(1," Les mots de passe ne correspondent pas "),e.k0s())}let g=(()=>{class o{fb;accountService;authService;router;toastService;passwordForm;constructor(a,r,s,i,F){this.fb=a,this.accountService=r,this.authService=s,this.router=i,this.toastService=F}ngOnInit(){this.initForm()}initForm(){const a={validators:this.passwordMatchValidator,updateOn:"blur"};this.passwordForm=this.fb.group({currentPassword:["",[t.k0.required]],newPassword:["",[t.k0.required,t.k0.minLength(8),t.k0.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/)]],confirmPassword:["",[t.k0.required]]},a)}passwordMatchValidator(a){const r=a.get("newPassword"),s=a.get("confirmPassword");return r&&s&&r.value!==s.value?{mismatch:!0}:null}onSubmit(){if(this.passwordForm.valid){const{currentPassword:a,newPassword:r}=this.passwordForm.value;this.accountService.updatePassword(a,r).subscribe({next:()=>{this.toastService.showSuccess("Mot de passe modifi\xe9 avec succ\xe8s. Vous allez \xeatre d\xe9connect\xe9."),this.passwordForm.reset(),setTimeout(()=>{this.authService.logout(),this.router.navigate(["/login"],{queryParams:{message:"Mot de passe modifi\xe9 avec succ\xe8s. Veuillez vous reconnecter."}})},3e3)},error:s=>{this.toastService.showError(s.error.message||"Une erreur est survenue lors de la modification du mot de passe")}})}else this.toastService.showError("Veuillez corriger les erreurs du formulaire")}isFieldInvalid(a){const r=this.passwordForm.get(a);return!!r&&r.invalid&&r.touched}static \u0275fac=function(r){return new(r||o)(e.rXU(t.ok),e.rXU(f.U),e.rXU(_.u),e.rXU(v.Ix),e.rXU(w.f))};static \u0275cmp=e.VBU({type:o,selectors:[["app-update-password"]],standalone:!0,features:[e.aNF],decls:28,vars:19,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-gradient-to-b","from-secondary","to-primary","py-12","px-4","sm:px-6","lg:px-8"],[1,"bg-white","p-8","rounded-2xl","shadow-xl","w-full","max-w-md","space-y-8"],[1,"text-center","space-y-4"],[1,"text-3xl","font-serif","font-bold","text-tertiary"],[1,"text-lg","text-gray-600","font-serif","italic"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","currentPassword",1,"block","text-lg","font-medium","text-tertiary","mb-2"],["id","currentPassword","type","password","formControlName","currentPassword","placeholder","Entrez votre mot de passe actuel",1,"w-full","p-3","border","border-secondary/30","rounded-lg","focus:ring-2","focus:ring-tertiary","focus:border-transparent","transition-all","duration-300",3,"ngClass"],[1,"mt-2","text-sm","text-red-600"],["for","newPassword",1,"block","text-lg","font-medium","text-tertiary","mb-2"],["id","newPassword","type","password","formControlName","newPassword","placeholder","Entrez votre nouveau mot de passe",1,"w-full","p-3","border","border-secondary/30","rounded-lg","focus:ring-2","focus:ring-tertiary","focus:border-transparent","transition-all","duration-300",3,"ngClass"],[1,"mt-1","text-sm","text-gray-500"],["for","confirmPassword",1,"block","text-lg","font-medium","text-tertiary","mb-2"],["id","confirmPassword","type","password","formControlName","confirmPassword","placeholder","Confirmez votre nouveau mot de passe",1,"w-full","p-3","border","border-secondary/30","rounded-lg","focus:ring-2","focus:ring-tertiary","focus:border-transparent","transition-all","duration-300",3,"ngClass"],[1,"pt-6"],[3,"text","type","color","rounded","disabled","customClass"]],template:function(r,s){if(1&r&&(e.j41(0,"section",0)(1,"div",1)(2,"div",2)(3,"h1",3),e.EFF(4," Modifier mon mot de passe "),e.k0s(),e.j41(5,"p",4),e.EFF(6," Assurez-vous d'utiliser un mot de passe s\xe9curis\xe9 "),e.k0s()(),e.nrm(7,"app-toast"),e.j41(8,"form",5),e.bIt("ngSubmit",function(){return s.onSubmit()}),e.j41(9,"div")(10,"label",6),e.EFF(11," Mot de passe actuel "),e.k0s(),e.nrm(12,"input",7),e.DNE(13,h,2,0,"p",8),e.k0s(),e.j41(14,"div")(15,"label",9),e.EFF(16," Nouveau mot de passe "),e.k0s(),e.nrm(17,"input",10),e.j41(18,"p",11),e.EFF(19," 8 caract\xe8res minimum avec majuscule, minuscule, chiffre et caract\xe8re sp\xe9cial "),e.k0s(),e.DNE(20,E,2,0,"p",8),e.k0s(),e.j41(21,"div")(22,"label",12),e.EFF(23," Confirmer le nouveau mot de passe "),e.k0s(),e.nrm(24,"input",13),e.DNE(25,P,2,0,"p",8),e.k0s(),e.j41(26,"div",14),e.nrm(27,"app-button",15),e.k0s()()()()),2&r){let i;e.R7$(8),e.Y8G("formGroup",s.passwordForm),e.R7$(4),e.Y8G("ngClass",e.eq3(13,d,s.isFieldInvalid("currentPassword"))),e.R7$(),e.vxM(s.isFieldInvalid("currentPassword")?13:-1),e.R7$(4),e.Y8G("ngClass",e.eq3(15,d,s.isFieldInvalid("newPassword"))),e.R7$(3),e.vxM(s.isFieldInvalid("newPassword")?20:-1),e.R7$(4),e.Y8G("ngClass",e.eq3(17,d,s.isFieldInvalid("confirmPassword")||s.passwordForm.hasError("mismatch"))),e.R7$(),e.vxM(s.passwordForm.hasError("mismatch")&&null!=(i=s.passwordForm.get("confirmPassword"))&&i.touched?25:-1),e.R7$(2),e.Y8G("text","Modifier le mot de passe")("type","submit")("color","tertiary")("rounded",!0)("disabled",s.passwordForm.invalid)("customClass","w-full font-bold shadow-md hover:shadow-lg transition-all duration-300 py-3")}},dependencies:[t.X1,t.qT,t.me,t.BC,t.cb,t.j4,t.JD,l.MD,l.YU,p.Q,m.d],encapsulation:2})}return o})()}}]);