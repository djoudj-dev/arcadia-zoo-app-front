@if (isModalOpen) {
<div
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
>
  <div
    class="bg-primary w-full sm:max-w-md mx-auto p-6 rounded-lg shadow-lg relative"
  >
    <!-- Bouton de fermeture de la modal -->
    <button
      (click)="closeModal()"
      class="absolute top-2 right-2 text-gray-400 hover:text-gray-600"
    >
      <svg
        class="w-6 h-6"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"
        />
      </svg>
    </button>

    <h1
      class="text-xl sm:text-2xl md:text-3xl font-bold text-quinary text-center mb-6"
    >
      Donnez votre avis
    </h1>

    <!-- Messages de succès ou d'erreur -->
    @if (successMessage) {
    <div
      class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4"
    >
      <p class="font-bold">Merci pour votre avis !</p>
      <p>{{ successMessage }}</p>
    </div>
    } @if (errorMessage) {
    <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4">
      <p class="font-bold">Erreur !</p>
      <p>{{ errorMessage }}</p>
    </div>
    }

    <!-- Formulaire d'avis -->
    <form
      [formGroup]="addReviewForm"
      (ngSubmit)="addReview()"
      class="space-y-6"
    >
      <!-- Nom avec validation -->
      <div>
        <label for="name" class="block mb-2 text-lg font-medium"
          >Votre nom :</label
        >
        <input
          type="text"
          id="name"
          formControlName="name"
          class="w-full rounded-lg bg-gray-50 border p-2.5"
          placeholder="Votre nom"
        />
        @if (f['name'].invalid && f['name'].touched) {
        <div class="text-red-600">
          @if (f['name'].errors && f['name'].errors['required']) {
          <small>Le nom est requis.</small>
          } @if (f['name'].errors && f['name'].errors['pattern']) {
          <small
            >Le nom ne doit contenir que des lettres, des espaces et des
            tirets.</small
          >
          }
        </div>
        }
      </div>

      <!-- Date -->
      <div>
        <label for="date" class="block mb-2 text-lg font-medium"
          >Date de visite :</label
        >
        <input
          type="date"
          id="date"
          formControlName="date"
          class="w-full bg-gray-50 border p-2.5"
        />
        @if (f['date'].invalid && f['date'].touched) {
        <div class="text-red-600">
          @if (f['date'].errors && f['date'].errors['required']) {
          <small>La date est requise.</small>
          }
        </div>
        }
      </div>

      <!-- Commentaire avec validation de longueur -->
      <div>
        <label for="message" class="block mb-2 text-lg font-medium"
          >Votre commentaire :</label
        >
        <textarea
          id="message"
          formControlName="message"
          rows="4"
          class="w-full block p-2.5 text-sm bg-gray-50 rounded-lg border"
          placeholder="Votre message"
        ></textarea>
        @if (f['message'].invalid && f['message'].touched) {
        <div class="text-red-600">
          @if (f['message'].errors && f['message'].errors['required']) {
          <small>Le commentaire est requis.</small>
          } @if (f['message'].errors && f['message'].errors['minlength']) {
          <small>Le commentaire doit comporter au moins 10 caractères.</small>
          } @if (f['message'].errors && f['message'].errors['maxlength']) {
          <small>Le commentaire ne doit pas dépasser 500 caractères.</small>
          }
        </div>
        }
      </div>

      <!-- Note -->
      <div>
        <label class="block mb-2 text-lg font-medium"
          >Notez le Zoo (sur 5) :</label
        >
        <app-rate formControlName="rating" [stars]="stars"></app-rate>
      </div>

      <!-- Case à cocher -->
      <div>
        <input id="checkbox" type="checkbox" formControlName="accepted" />
        <label for="checkbox" class="ml-2 text-sm font-medium">
          En cochant cette case, vous acceptez la publication de votre nom et
          commentaire.
        </label>
        @if (f['accepted'].invalid && f['accepted'].touched) {
        <div class="text-red-600">
          <small>Vous devez accepter pour soumettre.</small>
        </div>
        }
      </div>

      <!-- Bouton d'envoi -->
      <div>
        <app-button
          [text]="'Envoyer'"
          [type]="'submit'"
          [color]="'tertiary'"
          [rounded]="true"
        ></app-button>
      </div>
    </form>
  </div>
</div>
}
